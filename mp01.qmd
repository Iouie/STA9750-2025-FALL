---
title: "Netflix's Most Popular Programs: An Indepth Analysis"
author: Stanley Louie
date: "`r format(Sys.time(), '%B %d, %Y')`"
format:
  html:
    toc: true
    code-fold: true
    
---
![](assets/netflix_pic.jpg){width="100%"}  

# 1) SUMMARY

Netflix has been investing heavily in original TV series and film content with the main purpose of attracting a worldwide audience. Netflix is trying to put out a series of press releases highlighting their recent successes. The data analyzes the most popular Netflix films and TV shows between 2021 and 2025 in countries where Netflix is available and globally throughout the world.


# 2) DATA EXPLORATION

We are gathering the data from [Netflix's TumDum Top 10]([https://www.netflix.com/tudum/top10]), and cleaning it.

```{r, message=FALSE, warning=FALSE, results='hide'}

options(repos = c(CRAN = "https://cran.rstudio.com"))
install.packages(c("ggplot2", "dplyr", "readr", "rnaturalearth", "rnaturalearthdata"))


library(readr)
library(dplyr)
library(stringr)
library(DT)
library(rnaturalearth)
library(rnaturalearthdata)
library(ggplot2)


if(!dir.exists(file.path("data", "mp01"))){
    dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv", 
                  destfile=GLOBAL_TOP_10_FILENAME)
}

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

if(!file.exists(COUNTRY_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv", 
                  destfile=COUNTRY_TOP_10_FILENAME)
}

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

# Data cleaning to replace "N/A" string with N/A

GLOBAL_TOP_10 <- read_tsv(GLOBAL_TOP_10_FILENAME, na=c("N/A"))

COUNTRY_TOP_10 <- read_tsv(COUNTRY_TOP_10_FILENAME, na=c("N/A"))

```

# 3) FUN FACTS
* Netflix operates in **94** different countries.
```{r}
num_countries <- COUNTRY_TOP_10 %>% distinct(country_name) %>% count()
```

* Of all the non-english Netflix films, *All Quiet on the Western Front* ranks number one with **23** consecutive weeks in the global top 10.
```{r message=FALSE, warning=FALSE}
non_engtop10 <- GLOBAL_TOP_10 |> select(category, show_title, cumulative_weeks_in_top_10) |> 
  filter(category == "Films (Non-English)") |> 
  arrange(desc(cumulative_weeks_in_top_10))
```

* The longest film to have ever appeared in Netflix global Top 10 is *Pushpa P: The Rule (Reloaded Version)* which has a runtime of **224** minutes.

```{r}
longest_film <- GLOBAL_TOP_10 |> select(show_title, category, runtime) |> 
  filter(category == "Films (Non-English)" | category == "Films (English)")|> 
  mutate(runtime_mins = round(runtime * 60)) |> arrange(desc(runtime_mins)) |> 
  distinct(show_title, category, runtime, runtime_mins) 

longest_film |> 
    head(n=5) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |> 
  formatStyle(columns = names(longest_film),
              color ='white')
```

* Of the four categories of Netflix's Global Top 10, *TV (English)* has the most total hours of global viewership with a staggering **66,060,030,000** weekly hour views.
```{r}
total_weekly_viewers <- GLOBAL_TOP_10 %>% group_by(category) %>% 
  summarise(total = sum(weekly_hours_viewed)) %>% arrange(desc(total))
```

* *Money Heist* has the longest run in a country's Top 10 with **127** consecutive weeks in **Pakistan**.

```{r}
tv_tops <- COUNTRY_TOP_10 |> 
  select(category, show_title, cumulative_weeks_in_top_10,country_name) |> 
  filter(category == "TV") |> distinct(show_title, country_name, .keep_all = TRUE) |>
  arrange(desc(cumulative_weeks_in_top_10))

tv_tops |> 
    head(n=5) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |> 
  formatStyle(columns = names(tv_tops),
              color ='white')
```

* Throughout 2021 to 2025, only **Russia** has less than 200 weeks of service with only **35** weeks of data.

```{r}

country_removed <- COUNTRY_TOP_10 |> group_by(country_name) |> 
  summarise(num_weeks = n_distinct(week)) |> 
  arrange(num_weeks)

country_removed |> 
    head(n=3) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |> 
  formatStyle(columns = names(country_removed),
              color ='white')


```
* The total viewership for the TV show *Squid Game* from Season 1 to Season 3 is **5,048,300,000** hours.
```{r}
tot_hrs_squgame <- GLOBAL_TOP_10 |> 
  select(season_title, weekly_hours_viewed) |> 
  filter(str_detect(season_title, "Squid Game: Season")) |> 
  summarise(total_hrs = sum(weekly_hours_viewed))
```

* The movie *Red Notice* has **201,390,863** weekly hour views in 2021.
```{r}
red_weekly_views <- GLOBAL_TOP_10 |> 
  select(week, show_title, weekly_hours_viewed) |> 
  filter(str_detect(week, "2021"),show_title == "Red Notice") |> 
  summarise(total_wkly_hrs = sum(weekly_hours_viewed)) |>
  
#convert Red Notice film time from 1hr 58 mins to 1.97hrs

  summarise(red_total_views = total_wkly_hrs/ 1.97)

```

* There are **45** films that reached No.1 but did not originally debut with the most recent one being *Unknown Number: The High School Catfish* in the US.

```{r message=FALSE, warning=FALSE}
# Create a variable that stores only us films
us_films <- COUNTRY_TOP_10 |> 
  select(country_iso2,week, show_title, weekly_rank, category) |> 
  filter(country_iso2 == "US", category == "Films")
 
# Get all the films that eventually hit No.1 and most recent one.

us_tops <- us_films %>% group_by(show_title) %>% 
  summarise(debut_rank = weekly_rank[which.min(week)], 
            first_hit_week = min(week[weekly_rank == 1]), 
            hit_no1 = any(weekly_rank == 1)) %>% 
  filter(hit_no1, debut_rank != 1) %>% 
  select(show_title, debut_rank, first_hit_week) |> 
  arrange(desc(first_hit_week))

us_tops |> 
    head(n=5) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |> 
  formatStyle(columns = names(us_tops),
              color ='white')
```

* There are **7** TV shows tied that hit top 10 in the most countries during its debut week with **94** countries. 

```{r message=FALSE, warning=FALSE}

debut <- COUNTRY_TOP_10 %>% filter(category =="TV") %>% 
  group_by(show_title, country_name) %>% 
  summarise(debut_week = min(week), 
            debut_rank = weekly_rank[which.min(week)], 
            .groups="drop" ) %>% 
  group_by(show_title) %>% 
  summarise(countries_in_top_10 = n_distinct(country_name), 
            .groups= "drop") %>% 
  arrange(desc(countries_in_top_10))


debut |> 
    head(n=10) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |> 
  formatStyle(columns = names(debut),
              color ='white')
```

# 4) ENDGAME IN THE UPSIDE DOWN: STRANGER THINGS 5 BREAKS NEW GROUND

![Stranger Things 5](assets/strangerthings5.jpg){width="100%"}

Netflix's cultural phenomenon, *Stranger Things*, will unveil their fifth and final season on November 26. Since its debut in 2016, *Stranger Things* has captivated and garnered a worldwide audience, jump starting the trajectory of many Netflix original series that we know and love today. From the Upside Down to the Overworld, there will be a world where **Stranger Things** will reclaim its throne as Netflix's most popular TV show.


Throughout it's 4 seasons, *Stranger Things* has amassed **423,997,143** daily viewers.
```{r message=FALSE, warning=FALSE}
GLOBAL_TOP_10 |> select(show_title, weekly_hours_viewed) |> filter(show_title =='Stranger Things') |> 
  group_by(show_title) |> summarise(total_weekly_hrs_stranger_things = sum(weekly_hours_viewed)) |>
  mutate(daily_hours_viewed = 
           total_weekly_hrs_stranger_things / 7)
```

Out of the **94** countries that Netflix operates in, *Stranger Things* have been in the top 10 for **93** of them with an average of **13** consecutive weeks in the top 10.
```{r message=FALSE, warning=FALSE}
num_countries_top10 <- COUNTRY_TOP_10 |> 
  select(country_name, show_title, cumulative_weeks_in_top_10) |> 
  filter(show_title =='Stranger Things') |> 
  group_by(country_name) |> 
  summarise(num_countries = n_distinct(cumulative_weeks_in_top_10))

weekly_consecutive_top10_avg <- sum(num_countries_top10$num_countries) / 93

num_countries_top10 |> 
    datatable(options=list(paging=TRUE, searching=FALSE, info=FALSE)) |> 
  formatStyle(columns = names(num_countries_top10),
              color ='white')
```

Comparing *Stranger Things* to the **7** TV shows that hit top 10 during its debut week in **94** different countries, *Stranger Things* ranks as the **2nd highest total weekly hours** only behind the cultural phenomenon **Squid Game**. Nearly a decade after its debut, *Stranger Things* continue to prove its staying power and relevance in the ever changing landscape of TV shows. As the series heads toward its conclusion,  its continued dominance among the most-watched shows reaffirm its legacy as one of Netflix's defining franchises.
```{r warning=FALSE, message=FALSE}

library(ggplot2)
library(scales)

get_7_of_top10_debuts <- GLOBAL_TOP_10 |> 
  select(show_title, weekly_hours_viewed) |> 
  filter(show_title == "Stranger Things" | 
           show_title == "All of Us Are Dead" | 
           show_title == "Emily in Paris"| 
           show_title =="Inventing Anna" | 
           show_title == "Sex Education" | 
           show_title == "Squid Game" | 
           show_title =="The Witcher" | 
           show_title == "You") |> 
  group_by(show_title) |> 
  summarise(total_weekly_hours = sum(weekly_hours_viewed))

ggplot(get_7_of_top10_debuts, aes(x = reorder(show_title, -total_weekly_hours), 
                                  y = total_weekly_hours)) + 
  geom_col(fill = "#375b7f") + 
  labs(title = "Total Weekly Hour Views",x = "Show Title", 
       y = "Total Hours Viewed") + theme_minimal() + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale()))

```

# 5) FROM BOLLYWOOD TO BLOCKBUSTERS: INDIA IS ON THE RISE
![Netflix India](assets/netflix_india.jpeg){width="100%"}

India is starting to become one of the big players in the market. Hindi films have started to make strides and hitting top weekly charts. The Hindi film *RRR (Hindi)* has been in the top 10 cumulatively for **18** weeks. The show has a weekly hour view of **79,780,000**. Don't sleep on the other films either! All Hindi films that have appeared in Netflix's top 10 total up to **183,000,000** weekly hours viewed.

```{r}
top_hindi_films <- GLOBAL_TOP_10 |> select(show_title, weekly_hours_viewed) |> 
  filter(str_detect(show_title, "Hindi")) |> 
  group_by(show_title) |> 
  summarise(total_wkly_hrs = sum(weekly_hours_viewed)) |>
  slice_max(total_wkly_hrs, n = 5)

ggplot(top_hindi_films, aes(x= reorder(show_title, total_wkly_hrs), y=total_wkly_hrs)) +
  geom_col(fill = "#375b7f") +
  coord_flip() +
  labs(x ="Hindi Shows", y = "Weekly Hours Viewed", title = "Top Hindi Shows")+
  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale()))

```

```{r}
highest_cum_wks <- GLOBAL_TOP_10 %>% 
  filter(str_detect(show_title, "Hindi")) |> 
  group_by(show_title) |> 
  slice_max(cumulative_weeks_in_top_10, n=1) %>% ungroup() %>%
  arrange(desc(cumulative_weeks_in_top_10)) %>%
  slice_head(n = 5)

ggplot(highest_cum_wks, aes(x= reorder(show_title, -cumulative_weeks_in_top_10), 
                            y=cumulative_weeks_in_top_10)) +
  geom_col(fill = "#375b7f") +
  labs(x ="Hindi Shows", y = "Cumulative Weeks in Top 10", title = "Top Hindi Shows")
```

# 6) WWE AND NETFLIX TAG TEAM TO BRING WRESTLING FANS UNMATCHED ACCESS
![Netflix WWE](assets/netflix_wwe.jpg){width="100%"}

For over 70 years, *WWE* has been the heart and soul of sports entertainment, spanning across generations, developing iconic superstars, and generating legendary and unforgettable moments watched by millions across the globe. On January 6, 2025, *WWE* will officially be streamed live on Netflix. WWE fans will now be able to stream shows at anywhere, anytime, and on any device. Thousands of new audiences have already flocked in to watch *WWE*'s special Pay-Per-Views resulting in *WWE* getting into the weekly top 10 in **42** different countries!
```{r, fig.width=12, fig.height=8, warning=FALSE, message=FALSE}
wwe_tv <- COUNTRY_TOP_10 %>% filter(str_detect(show_title, "WWE"))

#get count of unique countries
wwe_tv %>% summarise(unique_count = n_distinct(country_name))

world_map <- rnaturalearth::ne_countries(scale = "medium", returnclass = "sf")

world_map <- world_map %>%
  mutate(highlight = admin %in% wwe_tv$country_name)

ggplot(world_map) +
  geom_sf(aes(fill = highlight), color = "grey80") +
  scale_fill_manual(values = c("TRUE" = "red", "FALSE" = "black")) +
  theme_minimal() +
  guides(fill = "none")
```
In the map above, we can see that *WWE* has a strong presence in North America, South America, Europe, and parts of Asia. However, there are still many countries in Africa and the Middle East that have yet to embrace the thrill of *WWE*. With Netflix's global reach, *WWE* has the potential to expand its audience and bring the excitement of wrestling to new regions. Speaking of regions, the graph below shows the number of times a WWE show has hit the weekly top 10. It's not surprising that the 2 biggest events, *WrestleMania* and *SummerSlam*, are the most popular show.
```{r}
country_count <- wwe_tv %>%
  group_by(show_title) %>%
  summarise(num_countries = n_distinct(country_name))

ggplot(country_count, aes(x= reorder(show_title, num_countries), y=num_countries)) +
  geom_col(fill = "#375b7f") +
  coord_flip() +
  labs(x ="WWE Shows", y = "# of Countries that WWE Hit Top 10", title = "WWE Popularity")
```

```{r}
#| include: false
1+1
```
--------------
Last Updated: `r format(Sys.time(), "%A %m %d, %Y at %H:%M%p")`
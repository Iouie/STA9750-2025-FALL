---
title: "Netflix's Most Popular Programs: An Indepth Analysis"
author: Stanley Louie
date: "`r format(Sys.time(), '%B %d, %Y')`"
format:
  html:
    toc: true
    code-fold: true
    
---
# 1) SUMMARY

Netflix has been investing heavily in original TV series and film content with the main purpose of attracting a worldwide audience. Netflix is trying to put out a series of press releases highlighting their recent successes. The data analyzes the most popular Netflix films and TV shows between 2021 and 2025 in countries where Netflix is available and globally throughout the world.

## 1.1) FUN FACTS

We are gathering the data from [Netflix's TumDum Top 10]([https://www.netflix.com/tudum/top10]) which consists of

* Global Top 10

* Country-wide Top 10

```{r message=FALSE, warning=FALSE}
if(!dir.exists(file.path("data", "mp01"))){
    dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv", 
                  destfile=GLOBAL_TOP_10_FILENAME)
}

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

if(!file.exists(COUNTRY_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv", 
                  destfile=COUNTRY_TOP_10_FILENAME)
}
library(readr)
library(dplyr)
library(stringr)
library(DT)

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

# Data cleaning to replace "N/A" string with N/A

GLOBAL_TOP_10 <- read_tsv(GLOBAL_TOP_10_FILENAME, na=c("N/A"))

COUNTRY_TOP_10 <- read_tsv(COUNTRY_TOP_10_FILENAME, na=c("N/A"))

```

* Netflix operates in **94** different countries.
```{r}
num_countries <- COUNTRY_TOP_10 %>% distinct(country_name) %>% count()
```

* Of all the non-english Netflix films, *All Quiet on the Western Front* spent **23** consecutive weeks in the global top 10.
```{r message=FALSE, warning=FALSE}
non_engtop10 <- GLOBAL_TOP_10 |> select(category, show_title, cumulative_weeks_in_top_10) |> 
  filter(category == "Films (Non-English)") |> 
  arrange(desc(cumulative_weeks_in_top_10))
```

* The longest film to have ever appeared in Netflix global Top 10 is *Pushpa P: The Rule (Reloaded Version)* which lasts for **224** minutes.

```{r}
longest_film <- GLOBAL_TOP_10 |> select(show_title, category, runtime) |> 
  filter(category == "Films (Non-English)" | category == "Films (English)")|> 
  mutate(runtime_mins = round(runtime * 60)) |> arrange(desc(runtime_mins)) |> 
  distinct(show_title, category, runtime, runtime_mins) 

longest_film |> 
    head(n=5) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |> 
  formatStyle(columns = names(longest_film),
              color ='white')
```

* Of the four categories of Netflix's Global Top 10, *TV (English)* has the most total hours of global viewership with a staggering **66,060,030,000** weekly hours viewed since 2021.
```{r}
total_weekly_viewers <- GLOBAL_TOP_10 %>% group_by(category) %>% 
  summarise(total = sum(weekly_hours_viewed)) %>% arrange(desc(total))
```

* *Money Heist* had the longest run in a country's Top 10 with **127** consecutive weeks in the top 10 in **Pakistan**.

```{r}
tv_tops <- COUNTRY_TOP_10 |> 
  select(category, show_title, cumulative_weeks_in_top_10,country_name) |> 
  filter(category == "TV") |> distinct(show_title, country_name, .keep_all = TRUE) |>
  arrange(desc(cumulative_weeks_in_top_10))

tv_tops |> 
    head(n=5) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |> 
  formatStyle(columns = names(tv_tops),
              color ='white')
```

* Throughout 2021 to 2025, only **Russia** has less than 200 weeks of service with only **35** weeks.

```{r}

country_removed <- COUNTRY_TOP_10 |> group_by(country_name) |> summarise(num_weeks = n_distinct(week)) |> arrange(num_weeks)

country_removed |> 
    head(n=3) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |> 
  formatStyle(columns = names(country_removed),
              color ='white')


```
* The total viewership for the TV show *Squid Game* from Season 1 to Season 3 is **5,048,300,000** hours.
```{r}
tot_hrs_squgame <- GLOBAL_TOP_10 |> 
  select(season_title, weekly_hours_viewed) |> 
  filter(str_detect(season_title, "Squid Game: Season")) |> 
  summarise(total_hrs = sum(weekly_hours_viewed))
```

* The movie *Red Notice* has **201,390,863** weekly hour views in 2021.
```{r}
red_weekly_views <- GLOBAL_TOP_10 |> 
  select(week, show_title, weekly_hours_viewed) |> 
  filter(str_detect(week, "2021"),show_title == "Red Notice") |> 
  summarise(total_wkly_hrs = sum(weekly_hours_viewed)) |>
  
#convert Red Notice film time from 1hr 58 mins to 1.97hrs

  summarise(red_total_views = total_wkly_hrs/ 1.97)

```

* There are **45** films that reached No.1 but did not originally debut with the most recent one being *Unknown Number: The High School Catfish* in the US.

```{r message=FALSE, warning=FALSE}
# Create a variable that stores only us films
us_films <- COUNTRY_TOP_10 |> 
  select(country_iso2,week, show_title, weekly_rank, category) |> 
  filter(country_iso2 == "US", category == "Films")
 
# Get all the films that eventually hit No.1 and most recent one.

us_tops <- us_films %>% group_by(show_title) %>% 
  summarise(debut_rank = weekly_rank[which.min(week)], 
            first_hit_week = min(week[weekly_rank == 1]), 
            hit_no1 = any(weekly_rank == 1)) %>% 
  filter(hit_no1, debut_rank != 1) %>% 
  select(show_title, debut_rank, first_hit_week) |> 
  arrange(desc(first_hit_week))

us_tops |> 
    head(n=5) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |> 
  formatStyle(columns = names(us_tops),
              color ='white')
```

* There are **7** TV shows tied that hit top 10 in the most countries during its debut week with **94** countries. 

```{r message=FALSE, warning=FALSE}

debut <- COUNTRY_TOP_10 %>% filter(category =="TV") %>% 
  group_by(show_title, country_name) %>% 
  summarise(debut_week = min(week), 
            debut_rank = weekly_rank[which.min(week)], 
            .groups="drop" ) %>% 
  group_by(show_title) %>% 
  summarise(countries_in_top_10 = n_distinct(country_name), 
            .groups= "drop") %>% 
  arrange(desc(countries_in_top_10))


debut |> 
    head(n=10) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |> 
  formatStyle(columns = names(debut),
              color ='white')
```

# 2) ENDGAME IN THE UPSIDE DOWN: STRANGER THINGS 5 BREAKS NEW GROUND

Netflix's cultural phenomenon, *Stranger Things*, will unveil their fifth and final season on November 26. Since its debut in 2016, *Stranger Things* has captivated and garnered a worldwide audience, jump starting the trajectory of many Netflix original series that we know and love today. From the Upside Down to the Overworld, there will definitely been a world where **Stranger Things** will reclaim its throne.


Throughout it's 4 season history, *Stranger Things* has amassed **423,997,143** daily viewers.
```{r message=FALSE, warning=FALSE}
GLOBAL_TOP_10 |> select(show_title, weekly_hours_viewed) |> filter(show_title =='Stranger Things') |> 
  group_by(show_title) |> summarise(total_weekly_hrs_stranger_things = sum(weekly_hours_viewed)) |>
  mutate(daily_hours_viewed = 
           total_weekly_hrs_stranger_things / 7)
```

As mentioned in the Fun Facts, Netflix operates in **94** different countries. Out of the **94** countries, *Stranger Things* have been in the  top 10 for **93** of them with an average of **13** consecutive weeks in the top 10.
```{r message=FALSE, warning=FALSE}
num_countries_top10 <- COUNTRY_TOP_10 |> select(country_name, show_title, cumulative_weeks_in_top_10) |> 
  filter(show_title =='Stranger Things') |> group_by(country_name) |> summarise(num_countries = n_distinct(cumulative_weeks_in_top_10))

weekly_consecutive_top10_avg <- sum(num_countries_top10$num_countries) / 93

num_countries_top10 |> 
    datatable(options=list(paging=TRUE, searching=FALSE, info=FALSE)) |> 
  formatStyle(columns = names(num_countries_top10),
              color ='white')
```

Comparing *Stranger Things* to the **7** TV shows that hit top 10 during its debut week in **94** different countries, *Stranger Things* ranks as the 2nd highest total weekly hours only behind the cultural phenomenon **Squid Game**, not bad for a show that has debut nearly 10 years ago.
```{r warning=FALSE, message=FALSE}

library(ggplot2)
library(scales)

get_7_of_top10_debuts <- GLOBAL_TOP_10 |> select(show_title, weekly_hours_viewed) |> filter(show_title == "Stranger Things" | show_title == "All of Us Are Dead" | show_title == "Emily in Paris"| show_title =="Inventing Anna" | show_title == "Sex Education" | show_title == "Squid Game" | show_title =="The Witcher" | show_title == "You") |> group_by(show_title) |> summarise(total_weekly_hours = sum(weekly_hours_viewed))

ggplot(get_7_of_top10_debuts, aes(x = reorder(show_title, -total_weekly_hours), y = total_weekly_hours)) + geom_col(fill = "#375b7f") + labs(title = "Total Weekly Hour Views",x = "Show Title", y = "Total Hours Viewed") + theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + scale_y_continuous(labels = label_number(scale_cut = cut_short_scale()))

```

# 3) FROM BOLLYWOOD TO BLOCKBUSTERS: INDIA IS ON THE RISE

India is starting to become one of the big players in the market. Hindi films have started to make strides and hitting top weekly charts. The Hindi film *RRR (Hindi)* been in the top 10 cumulatively for **18** weeks. The show itself have a weekly hour view of **79,780,000**. Don't sleep on the other films either! All Hindi films that have appeared in Netflix's top 10 total up to **183,000,000** weekly hours viewed.

```{r}
top_hindi_films <- GLOBAL_TOP_10 |> select(show_title, weekly_hours_viewed) |> 
  filter(str_detect(show_title, "Hindi")) |> 
  group_by(show_title) |> 
  summarise(total_wkly_hrs = sum(weekly_hours_viewed)) |>
  slice_max(total_wkly_hrs, n = 5)

ggplot(top_hindi_films, aes(x= reorder(show_title, total_wkly_hrs), y=total_wkly_hrs)) +
  geom_col(fill = "#375b7f") +
  coord_flip() +
  labs(x ="Hindi Shows", y = "Weekly Hours Viewed", title = "Top Hindi Shows")+
  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale()))

```

```{r}
highest_cum_wks <- GLOBAL_TOP_10 %>% 
  filter(str_detect(show_title, "Hindi")) |> 
  group_by(show_title) |> 
  slice_max(cumulative_weeks_in_top_10, n=1) %>% ungroup() %>%
  arrange(desc(cumulative_weeks_in_top_10)) %>%
  slice_head(n = 5)

ggplot(highest_cum_wks, aes(x= reorder(show_title, -cumulative_weeks_in_top_10), y=cumulative_weeks_in_top_10)) +
  geom_col(fill = "#375b7f") +
  labs(x ="Hindi Shows", y = "Cumulative Weeks in Top 10", title = "Top Hindi Shows")
```
```{r}
#| include: false
1+1
```
--------------
Last Updated: `r format(Sys.time(), "%A %m %d, %Y at %H:%M%p")`
---
title: "Netflix's Most Popular Programs: An Indepth Analysis"
author: Stanley Louie
date: "`r format(Sys.time(), '%B %d, %Y')`"
format:
  html:
    toc: true
    code-fold: true
    
---
# 1 SUMMARY

Netflix has been investing heavily in original TV series and film content with the main purpose of attracting a worldwide audience. Netflix is trying to put out a series of press releases highlighting their recent successes. The data analyzes the most popular Netflix films and TV shows between 2021 and 2025 in countries where Netflix is available and globally throughout the world.

## 1.1 FUN FACTS

We are gathering the data from [Netflix's TumDum Top 10]([https://www.netflix.com/tudum/top10]) which consists of

* Global Top 10

* Country-wide Top 10

```{r message=FALSE, warning=FALSE}
if(!dir.exists(file.path("data", "mp01"))){
    dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv", 
                  destfile=GLOBAL_TOP_10_FILENAME)
}

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

if(!file.exists(COUNTRY_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv", 
                  destfile=COUNTRY_TOP_10_FILENAME)
}
library(readr)
library(dplyr)
library(stringr)

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

# Data cleaning to replace "N/A" string with N/A

GLOBAL_TOP_10 <- read_tsv(GLOBAL_TOP_10_FILENAME, na=c("N/A"))

COUNTRY_TOP_10 <- read_tsv(COUNTRY_TOP_10_FILENAME, na=c("N/A"))

```

* Netflix operate in **94** different countries.
```{r}
num_countries <- COUNTRY_TOP_10 %>% distinct(country_name) %>% count()
```

* Of all the non-english Netflix films, *All Quiet on the Western Front* spent **23** consecutive weeks in the global top 10.
```{r message=FALSE, warning=FALSE}
non_engtop10 <- GLOBAL_TOP_10 |> select(category, show_title, cumulative_weeks_in_top_10) |> 
  filter(category == "Films (Non-English)") |> 
  arrange(desc(cumulative_weeks_in_top_10))
```

* The longest film to have ever appeared in Netflix global Top 10 is *Pushpa P: The Rule (Reloaded Version)* which lasts for **224** minutes.

```{r}
longest_film <- GLOBAL_TOP_10 |> select(show_title, category, runtime) |> 
  filter(category == "Films (Non-English)" | category == "Films (English)")|> 
  mutate(runtime_mins = round(runtime * 60)) |> arrange(desc(runtime_mins)) |> 
  distinct(show_title, category, runtime, runtime_mins) 
```

* Of the four categories of Netflix's Global Top 10, *TV (English)* has the most total hours of global viewership with a staggering **66,060,030,000** weekly hours viewed since 2021.
```{r}
total_weekly_viewers <- GLOBAL_TOP_10 %>% group_by(category) %>% 
  summarise(total = sum(weekly_hours_viewed)) %>% arrange(desc(total))
```

* *Money Heist* had the longest run in a country's Top 10 with **127** consecutive weeks in the top 10 in **Pakistan**.
```{r}
tv_tops <- COUNTRY_TOP_10 |> 
  select(category, show_title, cumulative_weeks_in_top_10,country_name) |> 
  filter(category == "TV") |> distinct(show_title, country_name, .keep_all = TRUE) |>
  arrange(desc(cumulative_weeks_in_top_10))
```

* Netflix provides over 200 weeks of service history for all but one country in our data set. Which country is this and when did Netflix cease operations in that country?

```{r}
#need to do
```
* The total viewership for the TV show *Squid Game* from Season 1 to Season 3 in hours is **5,048,300,000** hours.
```{r}
tot_hrs_squgame <- GLOBAL_TOP_10 |> 
  select(season_title, weekly_hours_viewed) |> 
  filter(str_detect(season_title, "Squid Game: Season")) |> 
  summarise(total_hrs = sum(weekly_hours_viewed))
```

* The movie *Red Notice* has **201,390,863** weekly hour views in 2021.
```{r}
red_weekly_views <- GLOBAL_TOP_10 |> 
  select(week, show_title, weekly_hours_viewed) |> 
  filter(str_detect(week, "2021"),show_title == "Red Notice") |> 
  summarise(total_wkly_hrs = sum(weekly_hours_viewed)) |>
  
#convert Red Notice film time from 1hr 58 mins to 1.97hrs

  summarise(red_total_views = total_wkly_hrs/ 1.97)

```

* There are **45** films that reached No.1 but did not originally debut with the most recent one being *Unknown Number: The High School Catfish* in the US.

```{r message=FALSE, warning=FALSE}
# Create a variable that stores only us films
us_films <- COUNTRY_TOP_10 |> 
  select(country_iso2,week, show_title, weekly_rank, category) |> 
  filter(country_iso2 == "US", category == "Films")
 
# Get all the films that eventually hit No.1 and most recent one.

us_tops <- us_films %>% group_by(show_title) %>% 
  summarise(debut_rank = weekly_rank[which.min(week)], 
            first_hit_week = min(week[weekly_rank == 1]), 
            hit_no1 = any(weekly_rank == 1)) %>% 
  filter(hit_no1, debut_rank != 1) %>% 
  select(show_title, debut_rank, first_hit_week) |> 
  arrange(desc(first_hit_week))
```

* There are **7** TV shows tied that hit top 10 in the most countries during its debut week with **94** countries. They are 
  * All of Us Are Dead
  * Emily in Paris
  * Inventing Anna
  * Sex Education
  * Squid Game
  * The Witcher
  * You
  
```{r message=FALSE, warning=FALSE}
debut <- COUNTRY_TOP_10 %>% filter(category =="TV") %>% 
  group_by(show_title, country_name) %>% 
  summarise(debut_week = min(week), 
            debut_rank = weekly_rank[which.min(week)], 
            .groups="drop" ) %>% 
  group_by(show_title) %>% 
  summarise(countries_in_top_10 = n_distinct(country_name), 
            .groups= "drop") %>% 
  arrange(desc(countries_in_top_10))
```

```{r}
#| include: false
1+1
```
--------------
Last Updated: `r format(Sys.time(), "%A %m %d, %Y at %H:%M%p")`